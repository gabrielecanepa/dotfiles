#!/bin/sh
# shellcheck disable=SC3028

# Core
alias ls="gls -h --color --group-directories-first -I .DS_Store -I 'Icon'$'\r'"
! command -v gls >/dev/null && alias ls="command ls -h -G -p"
alias ll="ls -la"
alias lss="du -sh * 2>/dev/null | sort -hr" # by size

# Paths
wd=$([[ -d "$WORKING_DIR" ]] && echo "$WORKING_DIR" || echo "$HOME")
tmp="$wd/tmp"
cloud="$HOME/Library/Mobile Documents/com~apple~CloudDocs"
obsidian="$HOME/Library/Mobile Documents/iCloud~md~obsidian/Documents"

# Directories
alias cdc="cd \"$cloud\""
alias cdw="cd $wd"
alias tmp="cd $tmp"
mkdircd() { mkdir -p "$@" && cd "$_" || return $?; }

# Files
alias aliases="$EDITOR $HOME/.aliases"
alias sshrc="$EDITOR $HOME/.ssh"
alias zshrc="$EDITOR $HOME/.zshrc"

# Functions
alias hide="chflags hidden"
alias unhide="chflags nohidden"

# Apps
alias te="open -a TextEdit"

# Shortcuts
alias omzr="omz reload"
alias ghrv="gh repo view --web"
alias ynpx="yarn dlx"

# Network
alias ip="echo $(curl -s ipinfo.io/ip)"
alias ips="ifconfig -a | perl -nle'/(\d+\.\d+\.\d+\.\d+)/ && print $1'"
alias server="ruby -run -e httpd . -p 8000"

# Git

# Short aliases: gcm → git cm → git commit -m
for git_alias in $(git aliases | sed 's/\ .*//'); do
  if ! command -v "g$git_alias" >/dev/null; then
    alias g"""${git_alias}"="git $git_alias"
  fi
done

unset git_alias

# VSCode

# Alias VSCode to VSCode Insiders if set as editor
[[ "$EDITOR" == "code-insiders" ]] && alias code="code-insiders"

# Workspaces: code-my-workspace → code ~/.vscode/workspaces/my-workspace.code-workspace
for vscode_workspace in $(find ~/.vscode/workspaces/*.code-workspace 2>/dev/null); do
  alias code-"""$vscode_workspace:t:r"="code $vscode_workspace"
done

unset vscode_workspace
